This example shows the use of c2numpy 1.1 (C interface) in CMSSW. The directory contains files and directories generated by the `mkedanlzr` script of CMSSW; we assume readers are familiar with that environment.

## Getting started

To reproduce it, run

```bash
cmsresl CMSSW_8_0_16
cd CMSSW_8_0_16/src
cmsenv
```

and copy in the `Demo` directory with its contents. Then

```bash
scram build
```

to compile it.

## What was added

We added c2numpy to this analyzer by copying the header file into `Demo/DemoAnalyzer/interface/c2numpy.h` (for some projects, you need to create the `interface` directory first). Then it was called by

  1. Adding `#include "Demo/DemoAnalyzer/interface/c2numpy.h"` at the top of `Demo/DemoAnalyzer/plugins/DemoAnalyzer.cc`.
  
  2. Adding `c2numpy_writer writer;` as member data in the `DemoAnalyzer` class.
  
  3. Adding a

     ```c++
c2numpy_init(&writer, "output/trackparams", 1000);
c2numpy_addcolumn(&writer, "pt", C2NUMPY_FLOAT64);
c2numpy_addcolumn(&writer, "eta", C2NUMPY_FLOAT64);
c2numpy_addcolumn(&writer, "phi", C2NUMPY_FLOAT64);
c2numpy_addcolumn(&writer, "dxy", C2NUMPY_FLOAT64);
c2numpy_addcolumn(&writer, "dz", C2NUMPY_FLOAT64);
```

     block in the `DemoAnalyzer` constructor.
  4. Adding a

     ```c++
for (auto track = tracks->cbegin();  track != tracks->end();  ++track) {
  c2numpy_float64(&writer, track->pt());
  c2numpy_float64(&writer, track->eta());
  c2numpy_float64(&writer, track->phi());
  c2numpy_float64(&writer, track->dxy());
  c2numpy_float64(&writer, track->dz());
}
```
     block in the `DemoAnalyzer::analyze` method.
  5. **This is important!** Adding a `c2numpy_close(&writer);` statement in `DemoAnalyzer::endJob()`.

## How to run it

If you're testing this on CERN LXPLUS or another AFS mounted machine (to see the dataset at `/afs/cern.ch/cms/Tutorials/TWIKI_DATA/TTJets_8TeV_53X.root`), simply do

```bash
mkdir output
cmsRun Demo/DemoAnalyzer/python/ConfFile_cfg.py
```

When CMSSW runs over the 10-event dataset, it produces seven files in `output` named `trackparams0.npy` through `trackparams6.npy`. To make one file, increase the number of rows per file (currently 1000) in the `c2numpy_init` call, recompile, and rerun.

These files should match the ones in this repository.

## What to do with the output

You can load any of the files in a Python session. Start a Python prompt and do

```python
trackparams0 = numpy.load("output/trackparams0.npy")
```

to get the recarray. This array represents a table of data with typed, named columns (just like a flat ROOT NTuple or a Pandas DataFrame). You can access it a column at a time:

```python
>>> trackparams0["pt"]
array([  0.58615864,   0.47248294,   1.74911408,   1.04643586,
         0.47096605,   0.59780441,   0.88029248,   3.06881774,
         0.66100567,   1.33790879,   0.65042406,   0.60015372,
         0.86379886,   0.57943386,   0.53491224,   1.0408088 ,
         1.55475394,   1.02831484,   0.47554129,   1.45042064,
...
```

a row at a time:

```python
>>> trackparams0[100]
(1.384070332555011, 0.18779495889500655, -1.6946575614328503, 0.19390893548491872, 0.39640133641298614)
>>> trackparams0.dtype.names
('pt', 'eta', 'phi', 'dxy', 'dz')
>>> trackparams0.dtype["pt"]
dtype('float64')
```

or any combination:

```python
>>> trackparams0["pt"][100:150]
array([ 1.38407033,  0.5997181 ,  2.64444269,  1.17549855,  2.81446767,
        1.41189475,  2.28960126,  0.56264374,  1.43745931,  0.78332034,
        1.34970658,  0.81638258,  1.52328245,  0.60757518,  1.1785421 ,
        0.81772201,  0.74880223,  0.69483397,  1.61993328,  0.59333001,
        1.15131582,  0.49265859,  2.57502517,  1.07178172,  0.67694687,
        0.463539  ,  1.4918132 ,  0.80275165,  0.86756021,  0.66508061,
        0.46361261,  1.27049738,  0.80131647,  0.59497201,  0.48336115,
        0.44257204,  0.47842197,  0.79463124,  0.77059007,  1.04439877,
        0.78301175,  0.53878087,  0.66803512,  1.03883587,  1.72249824,
        1.22609581,  0.96652589,  0.45579263,  0.62061272,  0.60283977])
```

## Importing to a Pandas DataFrame

TODO


